# name: test/sql/swarm_query.test
# description: test swarm extension distributed queries
# group: [swarm]

require swarm

# Verify swarm_tables returns empty when gossip is not running
query IIII
SELECT * FROM swarm_tables();
----

# Start gossip for testing
query I
SELECT swarm_start('127.0.0.1', 17947, 'query-test-cluster');
----
Swarm started on 127.0.0.1:17947 (cluster: query-test-cluster)

# Create a local test table
statement ok
CREATE TABLE orders AS SELECT i as id, 'region-' || (i % 3) as region, (i * 10.5) as price FROM range(100) t(i);

# Verify swarm_tables still empty (no catalog advertising yet)
query IIII
SELECT * FROM swarm_tables();
----

# Stop gossip
query I
SELECT swarm_stop();
----
Swarm stopped
